"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[790],{8817:function(e,t,l){l.d(t,{Z:function(){return b}});var a=l(3396),r=l(7139),i=l(9242);const d={"aria-label":"Page navigation example"},s={class:"pagination"},n=(0,a._)("span",{"aria-hidden":"true"},"«",-1),o=[n],u=["onClick"],p=(0,a._)("span",{"aria-hidden":"true"},"»",-1),c=[p];function _(e,t,l,n,p,_){return(0,a.wg)(),(0,a.iD)("nav",d,[(0,a._)("ul",s,[(0,a._)("li",{class:(0,r.C_)(["page-item",{disabled:!l.page.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,i.iM)((e=>_.updatePage(l.page.current_page-1)),["prevent"]))},o)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.page.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{key:e,class:(0,r.C_)(["page-item",{active:e==l.page.current_page}])},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,i.iM)((t=>_.updatePage(e)),["prevent"])},(0,r.zw)(e),9,u)],2)))),128)),(0,a._)("li",{class:(0,r.C_)(["page-item",{disabled:!l.page.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,i.iM)((e=>_.updatePage(l.page.current_page+1)),["prevent"]))},c)],2)])])}var h={props:["page"],methods:{updatePage(e){this.$emit("emit-page",e)}},emits:["emit-page"]},g=l(89);const m=(0,g.Z)(h,[["render",_]]);var b=m},8790:function(e,t,l){l.r(t),l.d(t,{default:function(){return ue}});var a=l(3396),r=l(7139),i=l(9242);const d={class:"container-fluid bg-light pt-5"},s={class:"container table table-hover"},n=(0,a._)("thead",{class:"table-dark"},[(0,a._)("tr",null,[(0,a._)("th",null,"購買時間"),(0,a._)("th",null,"Email"),(0,a._)("th",null,"購買款項"),(0,a._)("th",null,"應付金額"),(0,a._)("th",null,"是否付款"),(0,a._)("th",null,"編輯")])],-1),o={class:"bg-white"},u=["textContent"],p={class:"list-unstyled"},c={class:"text-right"},_={class:"form-check form-switch"},h=["id","onUpdate:modelValue","onChange"],g=["for"],m={key:0},b={key:1},w={class:"btn-group"},k=["onClick"],y=["onClick"];function f(e,t,l,f,v,O){const D=(0,a.up)("loadingTip"),x=(0,a.up)("Pagination"),M=(0,a.up)("OrderModal"),P=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(D,{active:v.isLoading},null,8,["active"]),(0,a._)("div",d,[(0,a._)("table",s,[n,(0,a._)("tbody",o,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.orders,((t,l)=>((0,a.wg)(),(0,a.iD)(a.HY,{key:l},[v.orders.length?((0,a.wg)(),(0,a.iD)("tr",{key:0,class:(0,r.C_)({"text-secondary":!t.is_paid})},[(0,a._)("td",null,(0,r.zw)(e.$filters.date(t.create_at)),1),(0,a._)("td",null,[t.user?((0,a.wg)(),(0,a.iD)("span",{key:0,textContent:(0,r.zw)(t.user.email)},null,8,u)):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("ul",p,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.products,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},(0,r.zw)(e.product.title)+" 數量："+(0,r.zw)(e.qty)+" "+(0,r.zw)(e.product.unit),1)))),128))])]),(0,a._)("td",c,(0,r.zw)(t.total),1),(0,a._)("td",null,[(0,a._)("div",_,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>O.updatePaid(t)},null,40,h),[[i.e8,t.is_paid]]),(0,a._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,a.wg)(),(0,a.iD)("span",m,"已付款")):((0,a.wg)(),(0,a.iD)("span",b,"未付款"))],8,g)])]),(0,a._)("td",null,[(0,a._)("div",w,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>O.openModal(!1,t)}," 檢視 ",8,k),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>O.openDelOrderModal(t)}," 刪除 ",8,y)])])],2)):(0,a.kq)("",!0)],64)))),128))])]),(0,a.Wm)(x,{class:"d-flex justify-content-center",page:v.pagination,onEmitPage:O.getOrders},null,8,["page","onEmitPage"])]),(0,a.Wm)(M,{order:v.tempOrder,ref:"orderModal",onUpdatePaid:O.updatePaid},null,8,["order","onUpdatePaid"]),(0,a.Wm)(P,{item:v.tempOrder,ref:"delModal",onDelItem:O.delOrder},null,8,["item","onDelItem"])],64)}var v=l(4334);const O={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},D={class:"modal-dialog modal-xl",role:"document"},x={class:"modal-content border-0"},M=(0,a._)("div",{class:"modal-header bg-dark text-white"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,a._)("span",null,"訂單細節")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P={class:"modal-body"},C={class:"row"},z={class:"col-md-4"},$=(0,a._)("h3",null,"用戶資料",-1),L={class:"table"},Z={key:0},H=(0,a._)("th",{style:{width:"100px"}},"姓名",-1),Y=(0,a._)("th",null,"Email",-1),j=(0,a._)("th",null,"電話",-1),q=(0,a._)("th",null,"地址",-1),E={class:"col-md-8"},K=(0,a._)("h3",null,"訂單細節",-1),U={class:"table"},W=(0,a._)("th",{style:{width:"100px"}},"訂單編號",-1),N=(0,a._)("th",null,"下單時間",-1),S=(0,a._)("th",null,"付款時間",-1),I={key:0},V={key:1},T=(0,a._)("th",null,"付款狀態",-1),A={key:0,class:"text-success"},B={key:1,class:"text-muted"},F=(0,a._)("th",null,"總金額",-1),G=(0,a._)("h3",null,"選購商品",-1),J={class:"table"},Q=(0,a._)("thead",null,[(0,a._)("tr")],-1),R={class:"text-end"},X={class:"modal-footer"},ee=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function te(e,t,l,i,d,s){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("div",D,[(0,a._)("div",x,[M,(0,a._)("div",P,[(0,a._)("div",C,[(0,a._)("div",z,[$,(0,a._)("table",L,[d.tempOrder.user?((0,a.wg)(),(0,a.iD)("tbody",Z,[(0,a._)("tr",null,[H,(0,a._)("td",null,(0,r.zw)(d.tempOrder.user.name),1)]),(0,a._)("tr",null,[Y,(0,a._)("td",null,(0,r.zw)(d.tempOrder.user.email),1)]),(0,a._)("tr",null,[j,(0,a._)("td",null,(0,r.zw)(d.tempOrder.user.tel),1)]),(0,a._)("tr",null,[q,(0,a._)("td",null,(0,r.zw)(d.tempOrder.user.address),1)])])):(0,a.kq)("",!0)])]),(0,a._)("div",E,[K,(0,a._)("table",U,[(0,a._)("tbody",null,[(0,a._)("tr",null,[W,(0,a._)("td",null,(0,r.zw)(d.tempOrder.id),1)]),(0,a._)("tr",null,[N,(0,a._)("td",null,(0,r.zw)(e.$filters.date(d.tempOrder.create_at)),1)]),(0,a._)("tr",null,[S,(0,a._)("td",null,[d.tempOrder.paid_date?((0,a.wg)(),(0,a.iD)("span",I,(0,r.zw)(e.$filters.date(d.tempOrder.paid_date)),1)):((0,a.wg)(),(0,a.iD)("span",V,"時間不正確"))])]),(0,a._)("tr",null,[T,(0,a._)("td",null,[d.tempOrder.is_paid?((0,a.wg)(),(0,a.iD)("strong",A,"已付款")):((0,a.wg)(),(0,a.iD)("span",B,"尚未付款"))])]),(0,a._)("tr",null,[F,(0,a._)("td",null,(0,r.zw)(e.$filters.currency(d.tempOrder.total)),1)])])]),G,(0,a._)("table",J,[Q,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.tempOrder.products,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",null,(0,r.zw)(t.product.title),1),(0,a._)("td",null,(0,r.zw)(t.qty)+" / "+(0,r.zw)(t.product.unit),1),(0,a._)("td",R,(0,r.zw)(e.$filters.currency(t.final_total)),1)])))),128))])])])])]),(0,a._)("div",X,[ee,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("update-order",d.tempOrder))}," 確認 ")])])])],512)}var le=l(1339),ae={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1}},emits:["update-product"],mixins:[le.Z],inject:["emitter"],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},re=l(89);const ie=(0,re.Z)(ae,[["render",te]]);var de=ie,se=l(8817),ne={data(){return{orders:{},isNew:!1,pagination:{},isLoading:!1,tempOrder:{},currentPage:1}},components:{Pagination:se.Z,DelModal:v.Z,OrderModal:de},methods:{getOrders(e=1){this.currentPage=e;const t=`https://vue3-course-api.hexschool.io/api/bear-work/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1,console.log(e)}))},openModal(e,t){this.tempOrder={...t},this.isNew=!1;const l=this.$refs.orderModal;l.showModal()},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},updatePaid(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/bear-work/admin/order/${e.id}`,l={is_paid:e.is_paid};this.$http.put(t,{data:l}).then((e=>{this.isLoading=!1,this.getOrders(this.currentPage),this.$httpMessageStatus(e,"更新付款狀態")}))},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/bear-work/admin/order/${this.tempOrder.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{console.log(e);const t=this.$refs.delModal;t.hideModal(),this.getOrders(this.currentPage)}))}},created(){this.getOrders(),console.log("https://vue3-course-api.hexschool.io/")}};const oe=(0,re.Z)(ne,[["render",f]]);var ue=oe}}]);
//# sourceMappingURL=790.b7e0e03b.js.map